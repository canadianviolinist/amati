header_footer_wgl_jsonp([7],{449:function(module,exports,__webpack_require__){var obj,_experiment=__webpack_require__(404),_experiment2=(obj=_experiment)&&obj.__esModule?obj:{default:obj};module.exports=function(){var expIds=_experiment2.default.getExpIds();return expIds.length>0?"&_customerExperiment="+expIds:""}},486:function(module,exports){var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj};function isDesktop(deviceType){return"string"!=typeof deviceType||"phone"!==deviceType.toLowerCase()&&"tablet"!==deviceType.toLowerCase()}module.exports=function(data){var jsonObj,deviceType=data&&data.meta&&data.meta.context&&data.meta.context.deviceType?data.meta.context.deviceType:"Desktop",compactData={},defaultMenu=data&&Array.isArray(data.menu)?data.menu:[],topMenu=[],menu={};for(var prop in isDesktop(deviceType)&&defaultMenu.forEach(function(srcFOB){var str,sourceFOB=srcFOB;"object"===(void 0===sourceFOB?"undefined":_typeof(sourceFOB))&&(Array.isArray(sourceFOB.children)||(sourceFOB.children=[]),topMenu.push(sourceFOB.id),menu[sourceFOB.id]={id:sourceFOB.id,text:(str=sourceFOB.text,"string"!=typeof str?"":str.charAt(0).toUpperCase()+str.substr(1).toLowerCase()),url:sourceFOB.url},menu[sourceFOB.id].children=function(targetPar,sourceFOB){for(var targetParent=targetPar,FOBChildren=[],column=void 0,blackCategory=void 0,shopCategory=void 0,tempLevelTwoObj=void 0,categoryObj=void 0,matchIdRegex=void 0,shopCategoryId=void 0,unknownIdNumber=Math.round((new Date).getTime()/1e4),parentObj=targetParent[sourceFOB.id],i=0;i<sourceFOB.children.length;i+=1){column=sourceFOB.children[i];for(var j=0;j<column.group.length;j+=1)if((blackCategory=column.group[j]).text.length||Array.isArray(blackCategory.children))if("image"!==blackCategory.mediaType.toLowerCase()&&blackCategory.text.length&&Array.isArray(blackCategory.children)){FOBChildren.push({id:blackCategory.id,text:blackCategory.text.length?blackCategory.text:blackCategory.children[0].group[0].text}),tempLevelTwoObj={},targetParent[blackCategory.id]=tempLevelTwoObj,tempLevelTwoObj.id=blackCategory.id,tempLevelTwoObj.text=blackCategory.text.length?blackCategory.text:blackCategory.children[0].group[0].text,tempLevelTwoObj.parent={id:parentObj.id,text:parentObj.text},tempLevelTwoObj.children=[];for(var k=0;k<blackCategory.children[0].group.length;k+=1)categoryObj={},unknownIdNumber+=1,(shopCategoryId=(matchIdRegex=(shopCategory=blackCategory.children[0].group[k]).url.match(/id=([^&]*)/))?matchIdRegex[1]:shopCategoryId="unknown_"+unknownIdNumber)!==parentObj.id&&shopCategoryId!==blackCategory.id||(shopCategoryId+="_category"),targetParent[shopCategoryId]=categoryObj,categoryObj.id=shopCategoryId,categoryObj.text=shopCategory.text,categoryObj.url=shopCategory.url,categoryObj.parent={id:blackCategory.id,text:blackCategory.text.length?blackCategory.text:blackCategory.children[0].group[0].text},tempLevelTwoObj.children.push(categoryObj)}else if(Array.isArray(blackCategory.children))for(var m=0;m<blackCategory.children[0].group.length;m+=1)tempLevelTwoObj={},(shopCategoryId=(matchIdRegex=(shopCategory=blackCategory.children[0].group[m]).url.match(/id=([^&]*)/))&&matchIdRegex[1]!==sourceFOB.id?matchIdRegex[1]:blackCategory.id)!==parentObj.id&&shopCategoryId!==blackCategory.id||(shopCategoryId+="_category"),targetParent[shopCategoryId]=tempLevelTwoObj,tempLevelTwoObj.id=shopCategoryId,tempLevelTwoObj.text=blackCategory.text.length?blackCategory.text:blackCategory.children[0].group[m].text,tempLevelTwoObj.parent={id:parentObj.id,text:parentObj.text},tempLevelTwoObj.url=blackCategory.children[0].group[m].url,FOBChildren.push(tempLevelTwoObj);else FOBChildren.push({id:blackCategory.id,text:blackCategory.text}),tempLevelTwoObj={},targetParent[blackCategory.id]=tempLevelTwoObj,tempLevelTwoObj.id=blackCategory.id,tempLevelTwoObj.text=blackCategory.text,tempLevelTwoObj.parent={id:parentObj.id,text:parentObj.text},tempLevelTwoObj.url=""}return FOBChildren}(menu,sourceFOB))}),data)"menu"===prop&&isDesktop(deviceType)?compactData.menu=menu:compactData[prop]=(jsonObj=data[prop],JSON.parse(JSON.stringify(jsonObj)||"{}"));return compactData.meta&&"object"===_typeof(compactData.meta)||(compactData.meta={}),compactData.meta.properties&&"object"===_typeof(compactData.meta.properties)||(compactData.meta.properties={}),"string"!=typeof compactData.meta.properties.topMenu&&(compactData.meta.properties.topMenu=""),isDesktop(deviceType)&&(compactData.meta.properties.topMenu=topMenu.join()),compactData}},557:function(module,exports,__webpack_require__){Object.defineProperty(exports,"__esModule",{value:!0});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target},_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol&&obj!==Symbol.prototype?"symbol":typeof obj},_jquery2=_interopRequireDefault(__webpack_require__(53)),_underscore2=_interopRequireDefault(__webpack_require__(27)),_Globals2=_interopRequireDefault(__webpack_require__(365)),_ParseObjectString2=_interopRequireDefault(__webpack_require__(418)),_getExperimentParam2=_interopRequireDefault(__webpack_require__(449)),_isDesktop2=_interopRequireDefault(__webpack_require__(567)),_mockLoader2=_interopRequireDefault(__webpack_require__(440)),_createMcomCompactDataFromDesktop2=_interopRequireDefault(__webpack_require__(486)),_setMcomHeaderClasses2=_interopRequireDefault(__webpack_require__(569));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}var adaptiveViewType="Radical",$body=void 0,$header=void 0,adaptiveViews={},getOppositeView=function(viewType){return viewType&&"string"==typeof viewType?"radical"===viewType.toLowerCase()?"Compact":"compact"===viewType.toLowerCase()?adaptiveViewType:"":""},toggleClass=function(viewType){"string"!=typeof viewType||"compact"!==viewType.toLowerCase()&&"radical"!==viewType.toLowerCase()||($header=(0,_jquery2.default)("header[data-uri]"),$body=(0,_jquery2.default)("body"),"compact"===viewType?(0,_jquery2.default)(".redesign-header-overlay.radical").hide():(0,_jquery2.default)(".redesign-header-overlay.compact").hide(),$header.addClass(viewType.toLowerCase()),$header.removeClass(getOppositeView(viewType).toLowerCase()),"radical"===viewType.toLowerCase()&&($header.removeClass("compact-redesign"),$body.removeClass("compact-redesign").removeClass("headerResponsive").removeClass("spa-enabled")),setTimeout(function(){(0,_jquery2.default)("header[data-uri]").css("max-height","none").removeClass("header-loading")},250))},createViewAndRender=function(create,options){"compact"===options.viewType.toLowerCase()?__webpack_require__.e(6).then(__webpack_require__.bind(null,485)).then(function(initCompactHeader){adaptiveViews[options.viewType]=initCompactHeader.default?initCompactHeader.default:initCompactHeader,adaptiveViews[options.viewType].init(create,options),adaptiveViews[options.viewType].render(toggleClass)}):__webpack_require__.e(16).then(__webpack_require__.bind(null,593)).then(function(initRadicalHeader){adaptiveViews[options.viewType]=initRadicalHeader.default?initRadicalHeader.default:initRadicalHeader;var radical=adaptiveViews[options.viewType].init(create,options);options.dbedHeaderRedesignEnabledDesktopExp?radical.then(function(){adaptiveViews[options.viewType].render(toggleClass)}):adaptiveViews[options.viewType].render(toggleClass)})},setAdaptiveViews=function(create,data,options){var deviceIsDesktop=options.IS_RENDERED?(0,_isDesktop2.default)(data):(0,_isDesktop2.default)(window),compactNavData="object"===(void 0===data?"undefined":_typeof(data))?(0,_createMcomCompactDataFromDesktop2.default)(data):(0,_createMcomCompactDataFromDesktop2.default)({}),properties=data&&data.meta&&data.meta.properties||{},context=data&&data.meta&&data.meta.context||{},isDesktopScreen=function(){return(window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth)>=1024&&deviceIsDesktop},createGenericViewAndRender=function(){var classes=((0,_setMcomHeaderClasses2.default)({context:{viewType:"Adaptive-"+options.viewType,deviceType:context.deviceType},properties:properties,isClientSideWGL:!options.IS_RENDERED})+" "+($header.hasClass("header-loading")||adaptiveViews.Compact&&!adaptiveViews[adaptiveViewType]?"header-loading":"")).trim();return $header.data("context",context).attr("data-context",JSON.stringify(context)).css("cssText",adaptiveViews[adaptiveViewType]?"":"max-height:"+$header.height()+"px;").attr("class",classes),_Globals2.default.setValue("dbedHeaderRedesignEnabledExp",!1),adaptiveViews[adaptiveViewType]?adaptiveViews[adaptiveViewType].reRender(toggleClass):createViewAndRender(create,{viewType:options.viewType,IS_RENDERED:!1,shippingCountry:options.shippingCountry,adaptiveNavData:data,dbedHeaderRedesignEnabledDesktopExp:properties.dbedHeaderRedesignEnabledDesktopExp})},createMewViewAndRender=function(){var mewContext={application:"MEW",deviceType:"TABLET",viewType:"Compact",shoppingMode:context.shoppingMode,regionCode:context.regionCode,domestic:context.domestic,currencyCode:context.currencyCode},classes=((0,_setMcomHeaderClasses2.default)({context:{deviceType:"TABLET",viewType:"Compact"},properties:{dbedHeaderRedesignEnabledExp:!0}})+" "+(!adaptiveViews.Compact?"header-loading":"")).trim();return $header.data("context",mewContext).attr("data-context",JSON.stringify(mewContext)).css("cssText",adaptiveViews.Compact?"":"max-height:"+$header.height()+"px;").attr("class",classes),_Globals2.default.setValue("dbedHeaderRedesignEnabledExp",!0),adaptiveViews.Compact?adaptiveViews.Compact.reRender(toggleClass):createViewAndRender(create,{viewType:"Compact",deviceType:"TABLET",deviceIsDesktop:deviceIsDesktop,IS_RENDERED:!1,hostlink:options.hostlink,adaptiveNavData:compactNavData,killswitches:_extends({},properties,{dbedHeaderRedesignRenderClient:!0,dbedHeaderRedesignEnabledExp:!0}),shippingCountry:options.shippingCountry,shoppingMode:options.shoppingMode,serviceproxy:options.serviceproxy})};isDesktopScreen()?createGenericViewAndRender():createMewViewAndRender();var handleWindowResize=_underscore2.default.debounce(function(){var isCompactView=$header.hasClass("compact");return isDesktopScreen()?isCompactView&&createGenericViewAndRender():!isCompactView&&createMewViewAndRender()},50);(0,_jquery2.default)(window).on("resize",handleWindowResize)};exports.default={createViewAndRender:createViewAndRender,getOppositeView:getOppositeView,init:function(create,opts){var viewType=opts.viewType,options=opts,media=(0,_jquery2.default)("script[data-mcom-header-media]").html(),menu=_ParseObjectString2.default.toObject((0,_jquery2.default)("script[data-mcom-header-menu-desktop]").html(),"[]"),meta=(0,_jquery2.default)("script[data-mcom-header-meta]").html();$header=(0,_jquery2.default)("header[data-uri]");var adaptiveNavData=void 0;if(!options.IS_RENDERED||!menu.length){var deviceIsDesktop=(0,_isDesktop2.default)(window),xapiParams=deviceIsDesktop?"&_deviceType=desktop&viewType=Adaptive":"&_deviceType=phone&viewType=Compact&_application=mew&bypass_redirect=yes";return(adaptiveNavData=new Promise(function(resolve){var url=options.serviceproxy+"?_regionCode="+options.shippingCountry+"&_shoppingMode="+options.shoppingMode+xapiParams+(0,_getExperimentParam2.default)();_jquery2.default.ajax({url:url,success:function(response){options.viewType="Radical",adaptiveViewType=options.viewType;var _ref$properties=(response&&response.meta||{}).properties,properties=void 0===_ref$properties?null:_ref$properties,viewClasses=(0,_setMcomHeaderClasses2.default)({context:{viewType:"Adaptive-"+options.viewType,deviceType:(0,_isDesktop2.default)(response)?"desktop":"phone"},properties:properties,isClientSideWGL:!options.IS_RENDERED}),loadingClass=viewType&&"compact"===viewType.toLowerCase()?"header-loading":"",classes=(viewClasses+" "+loadingClass).trim();loadingClass&&$header.css("cssText","max-height:"+$header.height()+"px;"),$header.attr("class",classes),resolve(response)},error:function(){var mockViewType=deviceIsDesktop?options.viewType:"Compact";Promise.resolve((0,_mockLoader2.default)({viewType:mockViewType,regionCode:options.shippingCountry,shoppingMode:options.shoppingMode})).then(function(data){resolve(data)})}})})).then(function(response){setAdaptiveViews(create,response,options)})}return adaptiveNavData={media:_ParseObjectString2.default.toObject(media,"{}"),menu:menu,meta:meta?_ParseObjectString2.default.toObject(meta,"{}"):{context:{},properties:{}}},options.viewType="Radical",adaptiveViewType=options.viewType,setAdaptiveViews(create,adaptiveNavData,options),Promise.resolve(adaptiveNavData)},setAdaptiveViews:setAdaptiveViews,toggleClass:toggleClass}}});
//# sourceMappingURL=header-footer-wgl.initAdaptiveHeader.f8641a61083c548ed0f5.js.map