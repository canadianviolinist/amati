(window.ordermodsreturns_ui_jsonp=window.ordermodsreturns_ui_jsonp||[]).push([["vendors~ordermods-returns"],{"4f9a14b6":function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0});var a=t("f13a385f"),n={getMessage:function(e,r){var t="",n="";switch(r){case a.PLATFORMS.WEB:n=e.split(";;")[0];break;case a.PLATFORMS.APP:n=e.split(";;")[1];break;default:n=""}var i=n.split("||");if(i[0]===r){var o=i[1],s=i[2];o&&a.ALERT_MSG_TYPES.includes(o.toLowerCase())&&s&&(t={type:o.toLowerCase(),message:s.split("__").join(" ")})}return t}};r.default=n},e927b876:function(e,r,t){Object.defineProperty(r,"__esModule",{value:!0}),r.renderShippingLabelPage=r.renderReturnSelectPage=r.handleNon200Error=r.renderReturnConfirmationPage=r.renderErrorPage=r.BodyApp=void 0;var a=w(t("710a8862")),n=S(t("e55076d5")),i=S(t("a6e757c4")),o=S(t("545e4a36")),s=S(t("414c571c")),d=S(t("078a9fdb")),l=S(t("4a8987a8")),u=S(t("eff50746")),c=S(t("789102c0")),f=w(t("780560a7")),h=w(t("62be2668")),p=w(t("a12a8731")),g=w(t("e41ba53c")),m=w(t("b15c5e5a")),y=w(t("4afe48b5")),v=w(t("007d5cef")),D=w(t("456c4bea")),b=t("f13a385f"),P=w(t("4f9a14b6"));function S(e){if(e&&e.__esModule)return e;var r={};if(null!=e)for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(r[t]=e[t]);return r.default=e,r}function w(e){return e&&e.__esModule?e:{default:e}}function k(e){return function(){var r=e.apply(this,arguments);return new Promise((function(e,t){return function a(n,i){try{var o=r[n](i),s=o.value}catch(e){return void t(e)}if(!o.done)return Promise.resolve(s).then((function(e){a("next",e)}),(function(e){a("throw",e)}));e(s)}("next")}))}}var E=t("f1a7a454").default,O=t("fe22a6df").default,R=t("42fc787c").default,I=t("3cee325e").default,T=t("933f0cd4").default,C=t("a25c573b").default,H=t("4a333308").default,M=t("2e3e853c").default,L=t("2d1f25ee").default,N=t("bf416f08").default,A=t("4b44f58c").default,x=t("ae9972e1").default,V=t("b4d726b0").default,U=t("9038dc00").default,_=t("8df885bd").default,j=[],F=!1,K=document.querySelectorAll("[data-bootstrap=configs]"),B=void 0;if(K&&K[0]&&((K=JSON.parse(K[0].innerHTML))&&!1===K.isProd&&(F=!1),K.orderReturnAlertMsg)){var G=P.default.getMessage(K.orderReturnAlertMsg,b.PLATFORMS.WEB);G&&G.message&&G.type&&(B={selector:"#"+h.default.brand+"-order-return-alert-msg",id:"order-return-alert-msg",content:G.message,state:"persistent",style:G.type,brand:h.default.brand})}var J,W,Z,z=new i.Application({pageData:null,returnSelectionData:{},returnPickupData:null,returnSummaryData:null,orderDetailsData:null,previousPage:!F||null,orderHistoryData:null,cachedOrders:{},purchaseHistoryPage:{type:"store",offset:0,limit:K.pageSize?K.pageSize:10},orderHistoryPage:{type:"digital"},phPageNumber:0,orderDetails:null,expandedOrderCount:2,initialize:function(){this.OrderDetailsPage=E,this.ReturnDetailsPage=U,this.PurchaseDetailsPage=O,this.OrderHistoryPage=R,this.PurchaseHistoryPage=I,this.OrderLookupPage=T,this.EasyReturnsPage=C,this.ErrorPage=H,this.DeepLinkGetLabel=V,this.Returnsv2SelectReturnItemsPage=M,this.Returnsv2SelectRefundPaymentPage=L,this.Returnsv2SelectReturnMethodPage=N,this.Returnsv2ReturnSummaryPage=A,this.Returnsv2ReturnConfirmationPage=x,this.InternationalOrderStatusPage=_},getData:function(e,r,t,n,i){if(!t){var o={};r&&0===r.indexOf("purchase-history")?o.className="right-of-center":"bcom"===h.default.brand&&(o.className="bcom-loading-large"),m.default.showLoader(o),"bcom"===h.default.brand&&((0,a.default)(".loader-container").addClass("ordermodsreturns-loader-container"),(0,a.default)(".loader").empty())}return new Promise((function(t,o){if(z.pageData&&"order-returns"===r&&t(z.pageData),"purchase-details"===r)z.purchaseData?t(z.purchaseData.orders.order):y.default.redirectToPurchaseHistory();else if(z.purchaseData&&"purchase-history"===r)t(z.purchaseData);else if(z.orderHistoryData&&"order-history"===r)t(z.orderHistoryData);else if(z.cachedOrders&&void 0!==z.cachedOrders[n]&&"order-details"===r){var s=z.cachedOrders[n];z.orderHistoryData.orders.order.length-1>=s&&t(z.orderHistoryData.orders.order[s])}else if(!i&&z.orderDetails&&"order-details-guest"===r)t(z.orderDetails);else if(e){var d={url:e,method:"GET",dataType:"json",timeout:1e4};m.default.requiresSecureHeader(r)&&(d.headers=m.default.getAPIHeaders(m.default.getSecureUserToken())),a.default.ajax(d).done((function(e){if("order-history"===r||"order-details"===r){var a=0,n=0,i=p.default.getChildProperty(e,"orders.order[0]"),o=p.default.getChildProperty(i,"shipments");o&&o.length>0&&(o.forEach((function(e){var r=p.default.getChildProperty(e,"items");r&&r.length>0&&g.default.isBackordered(e)&&r.forEach((function(e){e.cancelItemEligibleFlag&&n++,a++}))})),i.backorderedItemsCount=a,i.allItemsCanceled=n<=1)}if("order-history"===r&&(z.orderHistoryData=e,e.orders&&e.orders.order)){var s=void 0;s=e.orders.order.length-1>=z.expandedOrderCount?e.orders.order.slice(0,z.expandedOrderCount):e.orders.order,z.cachedOrders=m.default.updateCachedOrderMap(s,z.cachedOrders)}"order-returns"===r&&(z.pageData=e),r&&0===r.indexOf("purchase-history")&&("purchase-history-pagination"===r?z.purchaseData.orders.order=z.purchaseData.orders.order.concat(e.orders.order):z.purchaseData=e),t(e)})).fail((function(e,r){var t=e||{};if("timeout"===r){t.responseJSON={errors:{error:[{errorCode:"10001",message:"We're sorry. We're currently unable to retrieve your order info. Please try again later."}]}}}if("error"===r&&e.responseJSON&&(t.responseJSON=e.responseJSON,400===e.status?t.responseJSON.status=400:500===e.status&&(t.responseJSON.status=500)),!t.responseJSON){var a={errors:{error:[{errorCode:"10001",message:"At this time we are unable to retrieve your "+("digital"===z.orderHistoryPage.type?"online":"store")+" order information. Please try again later."}]}};t.responseJSON=a}o(t.responseJSON)}))}else t({})}))},postData:function(e,r,t){return m.default.showLoader(),new Promise((function(n,i){var o=0;e.endsWith("/return")&&(o=1e4),a.default.ajax({url:e,dataType:"json",type:"post",contentType:"application/json",data:JSON.stringify(r),processData:!1,timeout:o}).done((function(e){if("order-details"===t){var r=0,a=0,i=p.default.getChildProperty(e,"orders.order[0]"),o=p.default.getChildProperty(i,"shipments");o&&o.length>0&&(o.forEach((function(e){var t=p.default.getChildProperty(e,"items");t&&t.length>0&&g.default.isBackordered(e)&&t.forEach((function(e){e.cancelItemEligibleFlag&&a++,r++}))})),i.backorderedItemsCount=r,i.allItemsCanceled=a<=1)}m.default.hideLoader(),n(e)})).fail((function(e){m.default.hideLoader(),console.error("Ajax post error :: ",e),i(e)}))}))},setGlobalKillswitches:function(e){if(void 0!==e||null!==e){var r=!0,t=!1,a=void 0;try{for(var n,i=Object.keys(e)[Symbol.iterator]();!(r=(n=i.next()).done);r=!0){var s=n.value;o.setValue("props."+s,e[s])}}catch(e){t=!0,a=e}finally{try{!r&&i.return&&i.return()}finally{if(t)throw a}}}},saveSummaryData:function(e,r){var t=l.cloneDeep(this.copyOrderData),a=[],n={};if("step-1"===r){l.filter(e,(function(e){return e.itemSelected})).map((function(e){var r={upc:e.upc,selectedQuantity:e.selectedQuantity,mosFlag:e.mosFlag,lineNumber:e.lineNumber,itemSelected:e.itemSelected,returnQuantity:e.returnQuantity,reasonForReturnCode:e.reasonForReturnCode};return a.push(r)}));var i={billingContact:{emailAddress:p.default.getChildProperty(t,"returnDetails.orderHeaderInfo.billToCustomerType.billingContact.emailAddress")}};n={emailAddress:null,orderHeaderInfo:{orderNumber:p.default.getChildProperty(t,"returnDetails.orderHeaderInfo.orderNumber"),billToCustomerType:i},returnShipment:{returnEmail:p.default.getChildProperty(t,"returnDetails.returnShipment.returnEmail"),items:a,returnDropOffMethod:null},refundMethodDetails:{refundMethod:null},upcLineNumberMap:p.default.getChildProperty(t,"returnDetails.upcLineNumberMap")||{}},this.returnSelectionData.returnDetails=n}this.returnSelectionData.returnDetails&&("step-2"===r&&(this.returnSelectionData.returnDetails.emailAddress=e.email),"step-2-refund"===r&&(this.returnSelectionData.returnDetails.refundMethodDetails.refundMethod=e),"step-2-drop-n-go"===r&&(this.returnSelectionData.returnDetails.isDropNGoStoreAvailableNearMe=e),"step-3-choice"===r&&"PICKUP"!==e&&(delete this.returnSelectionData.returnDetails.returnPickup,delete this.returnSelectionData.returnDetails.returnPickupFlag),"step-3"===r&&(this.returnSelectionData.returnDetails.returnPickup=t.returnDetails.returnPickup,this.returnSelectionData.returnDetails.returnPickupFlag=t.returnDetails.returnPickupFlag,this.returnSelectionData.returnDetails.returnPickup.returnPickupSlots=t.returnDetails.returnPickup.selectedPickupSlot,delete this.returnSelectionData.returnDetails.returnPickup.selectedPickupSlot,delete this.returnSelectionData.returnDetails.returnPickup.selectedPickupTimeSlot,delete this.returnSelectionData.returnDetails.returnPickup.returnPickupAddress))}}),q=function(e){if(j=m.default.clearViews(j),e.killSwitches.responsiveOrderHistoryEnabled&&!y.default.isUserSignedIn()){var r=new z.OrderLookupPage({isSignedInUser:!1,omniChannelPurchaseHistoryEnabled:e.killSwitches.omniChannelPurchaseHistoryEnabled,responsiveOrderDetailsEnabled:e.killSwitches.responsiveOrderDetailsEnabled,returnPolicyAutomationEnabled:e.killSwitches.returnPolicyAutomationEnabled,backOrderModificationsEnabled:e.killSwitches.backOrderModificationsEnabled,ordermodsInternationalOrderTrackingEnabled:e.killSwitches.ordermodsInternationalOrderTrackingEnabled,customerServiceDomain:K.customerServiceDomain,csPagesOnIBMEnabled:e.killSwitches.csPagesOnIBMEnabled}).view;j.push(r),r.render()}else y.default.redirectToOrderStatus()},Q=function(e){j=m.default.clearViews(j),e=m.default.checkForTechnicalError(e),m.default.isValidSession(e);var r=new z.ErrorPage({error:e.error,configs:K}).view;j.push(r),r.render()},X=function(e,r){e&&e.message&&console.log(e,e.message);var t=p.default.getChildProperty(e,"errors.error[0].errorCode"),a=p.default.getChildProperty(e,"responseJSON.errors.error[0].errorCode"),n="40448"===a&&500===e.status,i="40449"===a&&400===e.status;if(n||i){var o=void 0;return o=n?"Sorry. We are experiencing a temporary error with our return pickup service. Please try again later or select another return method. We apologize for the inconvenience.":"Invalid address. Please enter a valid address and try again.",h.default.channel.trigger("reset:pickup:formdata",o),h.default.channel.trigger("do:nav",{href:"/my-orders/returns/select-return",trigger:!0,replace:!1}),!1}if(e.getResponseHeader&&"TRUE"===e.getResponseHeader("SESSION_TIMED_OUT"))return Q({error:{message:"You have been signed off. Please sign in again to continue."}}),y.default.redirectToSignin(),!1;if("purchase-history"===r||"purchases-category"===r){y.default.handleSessionTimeout(e),j=m.default.clearViews(j);var s=new z.PurchaseHistoryPage({error:e}).view;return j.push(s),s.render(),!1}if("order-history"===r){y.default.handleSessionTimeout(e),j=m.default.clearViews(j);var d=new z.OrderHistoryPage({orderDetails:"",responsiveOrderDetailsEnabled:!0,failureResponse:e}).view;return j.push(d),d.render(),!1}if("order-details"===r){y.default.handleSessionTimeout(e),j=m.default.clearViews(j);var l=new z.OrderDetailsPage({orderDetails:"",failureResponse:e}).view;return j.push(l),l.render(),!1}if("select-items"===r&&400===e.status)return y.default.handleSessionTimeout(e),j=m.default.clearViews(j),Q({error:{message:"This order was placed when you weren't signed in. To submit your return, sign out and then look up the order using the order number."}}),!1;if("print-label"===r&&"40450"===t)return y.default.handleSessionTimeout(e),j=m.default.clearViews(j),Q({error:{message:"Sorry, one or more items in this return is now beyond their return eligibility window."}}),!1;if("get-label"===r&&"40004"===t)return y.default.handleSessionTimeout(e),j=m.default.clearViews(j),Q({error:{message:"Sorry, one or more items in this return is now beyond their return eligibility window."}}),!1;var u=p.default.getChildProperty(e,"errors.error[0].message");if(500===e.status&&("order-details-guest"===r||"order-details"===r))return Q({error:{message:u}}),!1;if(500===e.status)return Q({error:{message:"<p>Sorry, we encountered an error in processing your return. Please come back later and try again. If you need further assistance, please visit our <a href='/service'>Customer Service Page</a>. Thank you for your patience.</p>"}}),!1;if("order-lookup"===r){return q({killSwitches:{responsiveOrderHistoryEnabled:!0}}),!1}return Q({error:{message:"<p>Sorry, we encountered an error in processing your return. Please come back later and try again. If you need further assistance, please visit our <a href='/service'>Customer Service Page</a>. Thank you for your patience.</p>"}}),y.default.redirectToOrderStatus(),!1},Y=function(e){j=m.default.clearViews(j),z.copyOrderData=e;var r=h.default.meta.properties,t=new(0,z.Returnsv2SelectReturnItemsPage)({returnItems:e.returnDetails,killswitches:r,configs:K,orderReturnAlertNotification:B}).view;j.push(t),t.render()},$=function(e){j=m.default.clearViews(j);var r={};r.orderId=p.default.getChildProperty(e,"returnDetails.orderHeaderInfo.orderNumber");var t=z.returnSelectionData;z.previousPage?z.postData(m.default.getDataURL(r,"confirmation","post"),t).then((function(e){if(e.error)if("OMR_DELIV_ERROR"===e.error.errorCode){h.default.channel.trigger("reset:pickup:formdata","Sorry. We are experiencing a temporary error with our return pickup service. Please try again later or select another return method. We apologize for the inconvenience."),h.default.channel.trigger("do:nav",{href:"/my-orders/returns/select-return",trigger:!0,replace:!1})}else Q(e);else{var r=new(0,z.Returnsv2ReturnConfirmationPage)({returnItems:e.returnDetails,labelUrl:e.returnDetails.labelUrl,killswitches:e.killSwitches||h.default.meta.properties,hosts:e.hosts,configs:K,isReturnFlowComplete:!0,orderReturnAlertNotification:B}).view;j.push(r),z.isReturnComplete=!0,r.render()}})).catch((function(e){console.error("AJAX request to pickup API failed: ",e),X(e)})):y.default.redirectToOrderStatus()},ee=function(e){j=m.default.clearViews(j);var r=h.default.meta.properties,t=new(0,z.Returnsv2ReturnConfirmationPage)({returnItems:e.returnDetails,labelUrl:e.returnDetails.labelUrl,killswitches:r,hosts:e.hosts,configs:K,isReturnFlowComplete:!1,orderReturnAlertNotification:B}).view;j.push(t),t.render()},re=function(e){j=m.default.clearViews(j),h.default.getKillSwitches().then((function(){var r=h.default.meta.properties,t=r.responsiveOrderDetailsEnabled,a=[];if(e.pddOrderMethodsExclusionList?a=e.pddOrderMethodsExclusionList:e.orders&&e.orders.pddOrderMethodsExclusionList&&(a=e.orders.pddOrderMethodsExclusionList),t){var n=new z.OrderDetailsPage({orderDetails:e.orders?e.orders.order[0]:e,returnPolicyAutomationEnabled:r.returnPolicyAutomationEnabled,orderTrackingEnhancementsEnabled:r.orderTrackingEnhancementsEnabled,orderTrackingSmsOptAlertEnabled:r.orderTrackingSmsOptAlertEnabled,backOrderModificationsEnabled:r.backOrderModificationsEnabled,globalPreciseDeliveryDateEnabled:r.globalPreciseDeliveryDateEnabled,pddOrderMethodsExclusionEnabled:r.pddOrderMethodsExclusionEnabled,pddOrderMethodsExclusionList:a,isReturnDetailViewEnabled:r.isReturnDetailViewEnabled,prosZoneCSGRedesignScalingEnabled:!!r.prosZoneCSGRedesignScalingEnabled,orderModsProsZoneEnabled:!!r.orderModsProsZoneEnabled,showPickupOptionsEnabled:r.showPickupOptionsEnabled}).view;j.push(n),n.render()}else v.default.redirectOrderDetails(e.orders?e.orders.order[0].number:e.number)}))},te=(J=k(regeneratorRuntime.mark((function e(r){var t,a;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return j=m.default.clearViews(j),t=void 0,e.prev=2,e.next=5,h.default.getKillSwitches();case 5:t=h.default.meta.properties,e.next=11;break;case 8:e.prev=8,e.t0=e.catch(2),s.log(e.t0.message);case 11:a=new z.PurchaseDetailsPage({orderDetails:r,prosZoneStoresPurchasesEnabled:!!t.prosZoneStoresPurchasesEnabled,prosZoneCSGRedesignScalingEnabled:!!t.prosZoneCSGRedesignScalingEnabled}).view,j.push(a),a.render();case 14:case"end":return e.stop()}}),e,void 0,[[2,8]])}))),function(e){return J.apply(this,arguments)}),ae=(W=k(regeneratorRuntime.mark((function e(r,t){var a,n,i,o,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r,n=f.default.get("macys_online_uid"),i=f.default.get("bloomingdales_online_uid"),j=m.default.clearViews(j),e.prev=4,e.next=7,h.default.getKillSwitches();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),s.log(e.t0.message);case 12:if(o=h.default.meta.properties.beautyReOrderEnabled,z.purchaseHistoryPage.category=t,o||y.default.redirectToPurchaseHistory(),void 0!==n||void 0!==i){a.items=(0,D.default)(a);try{z.purchaseHistoryPage.offset=r.orders.meta.nextOffset}catch(e){z.purchaseHistoryPage.offset=0}d=new z.PurchaseHistoryPage({storeOrdersData:a,disablePagination:z.phPageNumber>=2,hasPages:z.purchaseHistoryPage.offset>0,isCategoryView:!0}).view,j.push(d),d.render(),document.getElementById("pros-container")&&(document.getElementById("pros-container").style.display="none")}else y.default.redirectToSignin();case 16:case"end":return e.stop()}}),e,void 0,[[4,9]])}))),function(e,r){return W.apply(this,arguments)}),ne=(Z=k(regeneratorRuntime.mark((function e(r){var t,a,n,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=r,a=f.default.get("macys_online_uid"),n=f.default.get("bloomingdales_online_uid"),j=m.default.clearViews(j),e.prev=4,e.next=7,h.default.getKillSwitches();case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(4),s.log(e.t0.message);case 12:try{z.purchaseHistoryPage.offset=r.orders.meta.nextOffset}catch(e){z.purchaseHistoryPage.offset=0}a||void 0!==n?(i=new z.PurchaseHistoryPage({storeOrdersData:t,disablePagination:z.phPageNumber>=2,hasPages:z.purchaseHistoryPage.offset>0}).view,j.push(i),i.render(),document.getElementById("pros-container")&&(document.getElementById("pros-container").style.display="none")):y.default.redirectToSignin();case 14:case"end":return e.stop()}}),e,void 0,[[4,9]])}))),function(e){return Z.apply(this,arguments)});h.default.getKillSwitches=function(){return new Promise((function(e,r){var t=h.default.getMeta("properties");t&&Object.keys(t).length?e():a.default.get("/xapi/ordermodsreturns/v1/killswitches").done((function(t){if(t&&t.killSwitches){var a={};t.killSwitches.forEach((function(e){a[e.name]=e.value})),h.default.meta.properties=a,e()}else r()})).fail((function(){r()}))}))},h.default.channel.on("app:init-feature",(function(e){var r=e.feature,t=e.orderId,n=e.sectionName,i=e.category,o=e.returnShipmentToken,s=void 0===o?null:o;if(m.default.isNotOrdermodsReturns(r))j=m.default.clearViews(j);else{(0,a.default)(document).attr("title",m.default.getPageTitle(n));var d={},l=u.getUrlVars(window.location.href).trackingNos,g=void 0;if(t&&"print-label"!==n&&"get-label"!==n)"order-details"===n?d.orderId=t:"order-details-guest"===n?(d.token=t,l&&(d.trackingNos=l)):(d.returnsKey=encodeURIComponent(t),z.returnsKey=encodeURIComponent(t));else if(t&&"print-label"===n)d.token=u.getUrlVars(window.location.href).token;else if(s&&"return-details"===n){var v=u.getUrlVars(window.location.href).rdv;d.token=s,v&&(d.rdv=v)}else if(t&&"get-label"===n){d.token=u.getUrlVars(window.location.href).token;var D=u.getUrlVars(window.location.href).rdv;D&&(d.rdv=D)}var b="purchase-details"===n||"purchase-history"===n||"purchases-category"===n,P=["order-lookup","order-history","order-details","return-details"].includes(n),S=m.default.getAPIName(n),w=function(){z.getData(g,S,!1,t).then((function(e){var r=e;if(r.killSwitches){if(Array.isArray(r.killSwitches)){var a={};r.killSwitches.forEach((function(e){a[e.name]=e.value})),r.killSwitches=a}z.setGlobalKillswitches(r.killSwitches)}if(m.default.hideLoader(),e.error)Q(e);else if(z.isReturnComplete)y.default.redirect("/service/order-details");else switch(m.default.disableInfiniteScroll(),n){case"select-items":z.returnsKey||z.lookupParams||!F?Y(e):y.default.redirectToOrderStatus();break;case"select-refund":!function(e){j=m.default.clearViews(j);var r=h.default.meta.properties,t=z.Returnsv2SelectRefundPaymentPage;if(z.previousPage){var a=new t({returnItems:e.returnDetails,configs:K,killswitches:r,orderReturnAlertNotification:B}).view;j.push(a),a.render()}else y.default.redirectToOrderStatus()}(e);break;case"select-return":!function(e){j=m.default.clearViews(j);var r=h.default.meta.properties;if(z.previousPage){var t=void 0;"PICKUP"===e.returnDetails.returnShipment.returnDropOffMethod&&(t=e.returnDetails.returnPickup);var a=new(0,z.Returnsv2SelectReturnMethodPage)({returnItems:e.returnDetails,returnPickup:t,killSwitches:r,configs:K,orderReturnAlertNotification:B}).view;j.push(a),a.render()}else y.default.redirectToOrderStatus()}(e);break;case"submit":!function(e){j=m.default.clearViews(j);var r={},t=z.returnSelectionData;r.orderId=p.default.getChildProperty(e,"returnDetails.orderHeaderInfo.orderNumber"),z.previousPage?z.postData(m.default.getDataURL(r,"return-summary","post"),t).then((function(r){if(r.error)Q(r);else{var t=new(0,z.Returnsv2ReturnSummaryPage)({returnItems:e.returnDetails,returnSummary:r,killswitches:r.killSwitches||h.default.meta.properties,configs:K,orderReturnAlertNotification:B}).view;j.push(t),h.default.channel.trigger("do:nav",{href:"my-orders/returns/submit",trigger:!1}),t.render()}})).catch((function(e){console.error("AJAX request to pickup API failed: ",e),X(e)})):y.default.redirectToOrderStatus()}(e);break;case"confirmation":$(e);break;case"print-label":ee(e);break;case"get-label":!function(e){j=m.default.clearViews(j);var r=e.returnDetails,t=r.returnShipment,a=r.orderHeaderInfo,n=t.returnStatusDescription?t.returnStatusDescription:"",i=a.orderNumber?a.orderNumber:null;"SUBMITTED"===n?h.default.getKillSwitches().then((function(){var r=new(0,z.DeepLinkGetLabel)({returnDetails:e.returnDetails,killSwitches:h.default.meta.properties}).view;j.push(r),r.render()})):c.isSignedIn()&&i?y.default.redirectToOrderDetailsWithId(i,"?fromPage=getLabel"):y.default.redirectToPurchase()}(e);break;case"order-details":re(e);break;case"return-details":!function(e,r){j=m.default.clearViews(j),h.default.getKillSwitches().then((function(){var t=h.default.meta.properties,a=t.isReturnDetailViewEnabled,n=t.isStoreLocatorSearchEnabled;if(a){var i=new z.ReturnDetailsPage({configs:K,data:e,isStoreLocatorSearchEnabled:n,returnShipmentToken:r}).view;j.push(i),i.render()}else y.default.redirectToPurchase()}))}(e,s);break;case"order-details-guest":re(e);break;case"order-history":!function(e){j=m.default.clearViews(j),h.default.getKillSwitches().then((function(){var r=h.default.meta.properties,t=r.responsiveSignedInOrderHistoryEnabled,a=r.responsiveOrderDetailsEnabled,n=r.returnPolicyAutomationEnabled,i=r.orderTrackingEnhancementsEnabled,o=r.backOrderModificationsEnabled,s=r.ordermodsInternationalOrderTrackingEnabled,d=[];if(e.pddOrderMethodsExclusionList?d=e.pddOrderMethodsExclusionList:e.orders&&e.orders.pddOrderMethodsExclusionList&&(d=e.orders.pddOrderMethodsExclusionList),t){var l=new z.OrderHistoryPage({orderDetails:e,responsiveOrderDetailsEnabled:a,returnPolicyAutomationEnabled:n,orderTrackingEnhancementsEnabled:i,backOrderModificationsEnabled:o,ordermodsInternationalOrderTrackingEnabled:s,globalPreciseDeliveryDateEnabled:r.globalPreciseDeliveryDateEnabled,pddOrderMethodsExclusionEnabled:r.pddOrderMethodsExclusionEnabled,pddOrderMethodsExclusionList:d,isReturnDetailViewEnabled:r.isReturnDetailViewEnabled,customerServiceDomain:K.customerServiceDomain,csPagesOnIBMEnabled:r.csPagesOnIBMEnabled,medalliaSurveyEnabled:r.medalliaSurveyEnabled}).view;j.push(l),l.render()}else y.default.redirectToOrderStatus()}))}(e);break;case"purchases-category":ae(e,i);break;case"purchase-history":ne(e);break;case"purchase-details":te(m.default.getOrder(e,t));break;case"order-lookup":q(e);break;case"easy-returns":j=m.default.clearViews(j),h.default.getKillSwitches().then((function(){var e=h.default.meta.properties.responsiveOrderDetailsEnabled,r=h.default.meta.properties.ordermodsInternationalOrderTrackingEnabled,t=h.default.meta.properties.csPagesOnIBMEnabled,a=new z.EasyReturnsPage({configs:K,customerServiceDomain:K.customerServiceDomain,responsiveOrderDetailsEnabled:e,ordermodsInternationalOrderTrackingEnabled:r,csPagesOnIBMEnabled:t}).view;j.push(a),a.render()}));break;case"international-order":!function(){j=m.default.clearViews(j);var e=f.default.get("shippingCountry"),r=new z.InternationalOrderStatusPage({configs:K,shippingCountry:e,isProd:!(!K||!K.isProd)}).view;j.push(r),r.render()}();break;default:Q(e.error)}})).catch((function(e){m.default.hideLoader(),X(e,n)}))};if(b||P)"purchase-history"!==n&&"purchases-category"!==n||(d.type="store",d.category="purchases-category"===n?i:void 0),"order-history"===n&&(d.type="digital"),g=m.default.getDataURL(d,n);else if("easy-returns"===n)g=null;else if("order-details-guest"===n||"get-label"===n)g=m.default.getDataURL(d,n);else if("select-items"===n&&d.returnsKey||"print-label"===n)return void h.default.getKillSwitches().then((function(){var e=h.default.meta.properties;z.setGlobalKillswitches(e),d.returnsKey&&(d.lookupParams=d.returnsKey,delete d.returnsKey),g="print-label"!==n?m.default.getDataURL(d,S,""):m.default.getDataURL(d,"print-label",""),w()}));w()}})),h.default.channel.on("product:getReviews",(function(e){h.default.meta.properties.ordermodsBazaarVoiceEnabled&&e&&e.length>0&&a.default.ajax({url:"/xapi/ordermodsreturns/v1/orders/reviews?productList="+e,type:"GET",dataType:"JSON",contentType:"application/json",headers:m.default.getAPIHeaders(m.default.getSecureUserToken())}).done((function(r){r.reviews&&h.default.channel.trigger("update:review",r,e)}))})),h.default.channel.on("update:productlist:pagedata",(function(e,r){r?(z.pageData.returnDetails.returnShipment.items=e,z.saveSummaryData(e,"step-1")):z.pageData.returnDetails.returnShipment.lineItemList=e})),h.default.channel.on("update:refundmethod:options",(function(e){z.pageData.returnDetails.selectedRefundMethodValue=e,z.saveSummaryData(e,"step-2-refund")})),h.default.channel.on("update:returnMethod:options",(function(e){z.pageData.returnDetails.returnPickup&&"PICKUP"!==e&&delete z.pageData.returnDetails.returnPickup,z.pageData.returnDetails.returnShipment.returnDropOffMethod=e,z.saveSummaryData(e,"step-3-choice"),z.returnSelectionData.returnDetails&&(z.returnSelectionData.returnDetails.returnShipment.returnDropOffMethod=e)})),h.default.channel.on("showDropNGo:continue",(function(e){z.pageData.returnDetails.isDropNGoStoreAvailableNearMe=e.isDropNGoStoreAvailableNearMe,z.saveSummaryData(e,"step-2-drop-n-go")})),h.default.channel.on("update:returnMethod:pagedata",(function(e){z.pageData.returnDetails.returnPickup=e.returnPickup,z.saveSummaryData(e,"step-3")})),h.default.channel.on("update:contact:pageData",(function(e){z.pageData.returnDetails.emailAddress=e.email,z.pageData.returnDetails.phoneNumber=e.phone,z.saveSummaryData(e,"step-2")})),h.default.channel.on("update:previousPageLocation:pagedata",(function(e){z.previousPage=e})),h.default.channel.on("reset:pickup:formdata",(function(e){z.pageData.returnDetails.returnPickup=null,z.pageData.returnDetails.isDelivError=!0,z.pageData.returnDetails.delivErrorMessage=e})),h.default.channel.on("update:orderDetails",(function(e){z.orderDetails=e;var r=e.number,t=e.orderToken,a=0,i=0,o=p.default.getChildProperty(e,"shipments");o&&o.length>0&&(o.forEach((function(e){var r=p.default.getChildProperty(e,"items");r&&r.length>0&&g.default.isBackordered(e)&&r.forEach((function(e){e.cancelItemEligibleFlag&&i++,a++}))})),e.backorderedItemsCount=a,e.allItemsCanceled=i<=1),n.history.navigate("/purchases/online/"+r+"?o="+t,!0)})),h.default.channel.on("orderHistory:filterChanged",(function(e){var r=Object.assign({},z.orderHistoryPage);r.year="recent"!==e?e:void 0;var t=m.default.getDataURL(r,"order-history");z.orderHistoryData=void 0;var a="bcom"===h.default.brand;z.getData(t,"order-history",a).then((function(t){m.default.hideLoader(),z.OrderHistoryPage=r,h.default.channel.trigger("orderHistory:dataFetched",t,e)})).catch((function(e){m.default.hideLoader(),e.errorType="yearFilter"}))})),h.default.channel.on("purchaseHistory:filterChanged",(function(e){var r=Object.assign({},z.purchaseHistoryPage);r.offset=0,"recent"!==e?e.indexOf("Months")>-1?r.months=parseInt(e,10):r.year=e:(r.year=void 0,r.months=void 0);var t=m.default.getDataURL(r,"purchase-history");z.purchaseData=void 0,z.getData(t,"purchase-history").then((function(e){m.default.hideLoader(),z.purchaseHistoryPage=r,z.phPageNumber=0;try{z.purchaseHistoryPage.offset=e.orders.meta.nextOffset}catch(e){z.purchaseHistoryPage.offset=0}0===z.purchaseHistoryPage.offset&&(m.default.disableInfiniteScroll(),(0,a.default)("#js-ph-view-more").addClass("hide")),h.default.channel.trigger("purchaseHistory:dataFetched",e)})).catch((function(e){y.default.handleSessionTimeout(e),m.default.hideLoader(),e.errorType="yearFilter",h.default.channel.trigger("purchaseHistory:dataFetchError",e)}))})),h.default.channel.on("purchaseHistory:fetchData",(function(){if(!z.purchaseCallInProgress){z.purchaseCallInProgress=!0;var e=Object.assign({},z.purchaseHistoryPage),r=m.default.getDataURL(e,"purchase-history");d.show("#js-ph-view-more"),z.getData(r,"purchase-history-pagination",!0).then((function(r){z.purchaseHistoryPage=e,z.phPageNumber+=1;try{z.purchaseHistoryPage.offset=r.orders.meta.nextOffset}catch(e){z.purchaseHistoryPage.offset=0}0===z.purchaseHistoryPage.offset?(m.default.disableInfiniteScroll(),(0,a.default)("#js-ph-view-more").addClass("hide"),(0,a.default)(".filter-info-msg").addClass("show")):2===z.phPageNumber&&(m.default.disableInfiniteScroll(),(0,a.default)("#js-ph-view-more").removeClass("hide"),(0,a.default)(".filter-info-msg").hasClass("show")&&(0,a.default)(".filter-info-msg").removeClass("show")),h.default.channel.trigger("purchaseHistory:moarDataFetched",r),m.default.hideLoader(),d.hide("#js-ph-view-more"),z.purchaseCallInProgress=!1})).catch((function(e){y.default.handleSessionTimeout(e),e.errorType="pagination",h.default.channel.trigger("purchaseHistory:dataFetchError",e),m.default.disableInfiniteScroll(),m.default.hideLoader(),d.hide("#js-ph-view-more"),z.purchaseCallInProgress=!1}))}})),h.default.channel.on("onlineHistory:fetchData",(function(e){var r=e.indexInArray,t=e.transactionDate,a=e.orderTotal,n=e.isODRefresh,i=e.lineNumber,o=e.orderId,s=e.lookupFormData,d={orderId:o},l=m.default.getDataURL(d,"order-details");n&&s?z.postData(l,s,"order-details").then((function(e){var t={indexInArray:r,orderData:e.orders.order[0],isODRefresh:n,lineNumber:i};h.default.channel.trigger("orderDetail:fetched",t)})).catch((function(e){var n={error:e,indexInArray:r,orderId:d.orderId,transactionDate:t,orderTotal:a};h.default.channel.trigger("onlineHistory:errorMessage",n),y.default.handleSessionTimeout(e)})):z.getData(l,"order-details",!0,null,n).then((function(t){z.orderHistoryData&&z.orderHistoryData.orders&&z.orderHistoryData.orders.order.length-1>=r&&(z.orderHistoryData.orders.order[r]=t.orders.order[0],z.cachedOrders[e.orderId]=parseInt(r,10));var a={indexInArray:r,orderData:t.orders.order[0],isODRefresh:n,lineNumber:i};h.default.channel.trigger("orderDetail:fetched",a)})).catch((function(e){var n={error:e,indexInArray:r,orderId:d.orderId,transactionDate:t,orderTotal:a};h.default.channel.trigger("onlineHistory:errorMessage",n),y.default.handleSessionTimeout(e)}))})),h.default.channel.on("onlineDetails:fetchReturnTracking",(function(e){var r=m.default.getDataURL(e,"tracking-details");z.getData(r,"tracking-details",!0).then((function(e){h.default.channel.trigger("trackingDetail:fetched",e)})).catch((function(e){h.default.channel.trigger("trackingDetail:error",e)}))})),r.BodyApp=z,r.renderErrorPage=Q,r.renderReturnConfirmationPage=$,r.handleNon200Error=X,r.renderReturnSelectPage=Y,r.renderShippingLabelPage=ee}}]);
//# sourceMappingURL=ordermodsreturns-ui.vendors~ordermods-returns.f6c1a523c786c36f5dc0.js.map